package data.prompt

/**
 * Билдер для создания промптов со структурированным выводом
 */
class StructuredPromptBuilder {

    /**
     * Создает промпт для получения рецепта блюда от шеф-повара
     *
     * @param dishName Название блюда
     * @return Промпт для LLM с требованием структурированного JSON ответа
     */
    fun buildRecipePrompt(dishName: String): String {
        return """
Ты — шеф-повар мирового класса и эксперт кулинарии с многолетним опытом.

ВАЖНО: Твой ответ ДОЛЖЕН быть ТОЛЬКО валидным JSON, без дополнительного текста, без markdown форматирования.

Предоставь полный рецепт блюда: "$dishName"

Верни результат СТРОГО в следующем JSON формате:
{
  "name": "точное название блюда",
  "country": "страна происхождения блюда",
  "ingredients": [
    {
      "name": "название ингредиента",
      "amount": "количество",
      "unit": "единица измерения (г, мл, шт, по вкусу, и т.д.)"
    }
  ],
  "instructions": [
    "Шаг 1: подробное описание",
    "Шаг 2: подробное описание",
    "Шаг 3: подробное описание"
  ],
  "history": "Краткая история блюда в 2-3 предложениях, описывающая происхождение и культурное значение"
}

Требования к формату:
- name: точное название блюда на русском
- country: страна происхождения (Россия, Италия, Франция, и т.д.)
- ingredients: список всех необходимых ингредиентов с точными количествами
- instructions: пошаговая инструкция приготовления (минимум 5 шагов)
- history: интересная история о блюде, 2-3 предложения

НЕ добавляй:
- Markdown форматирование (```json)
- Дополнительный текст до или после JSON
- Комментарии внутри JSON

Пример для блюда "Борщ":
{
  "name": "Борщ украинский",
  "country": "Украина",
  "ingredients": [
    {"name": "Свекла", "amount": "300", "unit": "г"},
    {"name": "Капуста белокочанная", "amount": "200", "unit": "г"},
    {"name": "Картофель", "amount": "3", "unit": "шт"},
    {"name": "Морковь", "amount": "1", "unit": "шт"},
    {"name": "Лук репчатый", "amount": "1", "unit": "шт"},
    {"name": "Томатная паста", "amount": "2", "unit": "ст.л."},
    {"name": "Говядина на кости", "amount": "500", "unit": "г"},
    {"name": "Чеснок", "amount": "3", "unit": "зубчика"},
    {"name": "Уксус", "amount": "1", "unit": "ст.л."},
    {"name": "Соль", "amount": "по вкусу", "unit": null},
    {"name": "Перец черный молотый", "amount": "по вкусу", "unit": null},
    {"name": "Лавровый лист", "amount": "2", "unit": "шт"},
    {"name": "Растительное масло", "amount": "3", "unit": "ст.л."}
  ],
  "instructions": [
    "Говядину промыть, залить 2,5 литрами холодной воды, поставить на огонь. После закипания снять пену, посолить, добавить лавровый лист и варить на медленном огне 1,5-2 часа",
    "Свеклу очистить, натереть на крупной терке, сбрызнуть уксусом и оставить на 10 минут для сохранения цвета",
    "Картофель очистить и нарезать кубиками, добавить в бульон за 20 минут до готовности мяса",
    "Капусту нашинковать и добавить в бульон одновременно с картофелем",
    "Лук мелко нарезать, морковь натереть на терке. Обжарить лук на растительном масле до золотистого цвета, добавить морковь и жарить еще 3 минуты",
    "Добавить в зажарку свеклу и томатную пасту, тушить 5-7 минут под крышкой на медленном огне",
    "Переложить зажарку в кастрюлю с бульоном, варить еще 10 минут",
    "Чеснок измельчить, добавить в борщ за 2 минуты до готовности",
    "Снять с огня, дать настояться под крышкой 15-20 минут. Подавать со сметаной и чесночными пампушками"
  ],
  "history": "Борщ — традиционное блюдо восточнославянской кухни, символ украинской культуры. Первые упоминания о блюде датируются XVI веком, когда свекла стала основным ингредиентом супа. В 2022 году ЮНЕСКО включило культуру приготовления украинского борща в список нематериального культурного наследия, нуждающегося в срочной охране."
}

Теперь предоставь рецепт для блюда: "$dishName"
        """.trimIndent()
    }
}